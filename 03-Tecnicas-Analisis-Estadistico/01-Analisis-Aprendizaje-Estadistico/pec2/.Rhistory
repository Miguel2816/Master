View(iris)
unique(iris$Species)
install.packages(c("GGally", "ggplot2"))
ggpairs(iris, mapping=ggplot2::aes(colour = Species))
install.packages("leaflet")
shinyApp(ui, server)
install.packages(c("shiny"),("leaflet"))
shinyApp(ui, server)
server <- function(input, output, session) {
points <- eventReactive(input$recalc, {
points = cbind(rnorm(40) * 2 + 13, rnorm(40) + 48)
return(points)
}, ignoreNULL = FALSE)
observeEvent(input$Map_shape_click, { # update the location selectInput on map clicks
output$coordinates <- renderText({
"You have selected this"
})
})
output$mymap <- renderLeaflet({
leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite,
options = providerTileOptions(noWrap = TRUE)
) %>%
addMarkers(data = points())
})
}
shinyApp(ui, server)
shinyApp(ui, server)
library(leaflet)
install.packages('tidyverse')
library(tidyverse)
install.packages(c("nycflights13", "gapminder", "Lahman"))
sessioninfo::session_info(c("tidyverse"))
x
x<-3*4
print(x)
r_rock <- 8
y <- seq(1,20,length.out = 4)
y <- seq(1,20,length.out = 4)
source('~/.active-rstudio-document')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/Libro-Test.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
View(determinante)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
install.packages('lsa')
source('~/.active-rstudio-document')
print(doble(c(2,3,4)))
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/sesion-presencial.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/Exercises/bub_sort.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/Exercises/bub_sort.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/Exercises/bub_sort.R')
source('~/Desktop/MIGUEL/Courses/Master/03-Entornos-Analisis-Datos-R/01-Lenguaje-R-Intro-Tidyverse/Exercises/bub_sort.R')
install.packages('ssh')
install.packages("RODBC")
install.packages("odbc")
set.seed(2014)
n = 1000000
dado1 = sample(1:6, n, replace=TRUE)
dado2 = sample(1:6, n, replace=TRUE)
suma = dado1 + dado2
table(suma)/n
valores = 2:12
probabilidades = c(1:6,5:1)/36
mu=sum(valores*probabilidades)
varianza=sum((valores-mu)^2*probabilidades)
sigma=sqrt(varianza)
cumsum(probabilidades)
hect_perd_porc <- c(0,25,50,100)
prob_hect <- c(0.9,0.05,0.02,0.03)
valor_medio <- sum(hect_perd_porc*prob_hect)/100
valor_medio <- (sum(hect_perd_porc*prob_hect)/100)*150
valor <- c(0,1,2,3,4,5)
prob <- c(1/6,1/12,1/4,1/4,1/12,/16)
prim_valor_medio <- 5*sum(valor*prob) + 1
seg_valor_medio <- sum((valor*prob)^2)
valor <- c(0,1,2,3,4,5)
prob <- c(1/6,1/12,1/4,1/4,1/12,1/16)
prim_valor_medio <- 5*sum(valor*prob) + 1
seg_valor_medio <- sum((valor*prob)^2)
valor <- c(0,1,2,3,4,5)
prob <- c(1/6,1/12,1/4,1/4,1/12,1/16)
prim_valor_medio <- 5*(sum(valor*prob)) + 1
seg_valor_medio <- sum((valor*prob)^2)
valor <- c(0,1,2,3,4,5)
prob <- c(1/6,1/12,1/4,1/4,1/12,1/6)
prim_valor_medio <- 5*(sum(valor*prob)) + 1
seg_valor_medio <- sum((valor*prob)^2)
pos_totales <- 6^3
pos_3x <- 1/pos_totales
pos_2x <- (5*3)/pos_totales
pos_1x <- (5*5*3)/pos_totales
pos_neg <- 1 - pos_3x - pos_2x - pos_1x
posibilidades <- (-1,1,2,3)
probabilidad <- (pos_neg, pos_1x, pos_2x, pos_3x)
ben_esp <- sum(posibilidades*probabilidad)
pos_totales <- 6^3
pos_3x <- 1/pos_totales
pos_2x <- (5*3)/pos_totales
pos_1x <- (5*5*3)/pos_totales
pos_neg <- 1 - pos_3x - pos_2x - pos_1x
posibilidades <- c(-1,1,2,3)
probabilidad <- c(pos_neg, pos_1x, pos_2x, pos_3x)
ben_esp <- sum(posibilidades*probabilidad)
valor_ej6 <- c(6,7,8,9,10)
prob_ej6 <- c(0.05, 0.1, 0.6, 0.15, 0.1)
# Funcion de distribucion F acumulada
fun_dist_ej6 <- rbind(valor_ej6,cumsum(prob_ej6))
View(fun_dist_ej6)
valor_ej6 <- c(6,7,8,9,10)
prob_ej6 <- c(0.05, 0.1, 0.6, 0.15, 0.1)
# Funcion de distribucion F acumulada
fun_dist_ej6 <- rbind(valor_ej6,cumsum(prob_ej6))
# Usar F para calcular P(X ≤ 8)
p_x_menorigual_8 <- fun_dist_ej6[2,3]
# Usar F para calcular P(X < 8)
p_x_menor_8 <- fun_dist_ej6[2,2]
#Usar F para calcular P(X > 7)
p_x_menor_7 <- fun_dist_ej6[2,1]
# Usar F para calcular P(7 ≤ X ≤ 9).
# p menor o igual que 7 es igual a p menor que ocho
p_menorigual_9 <- fun_dist_ej6[2,4]
p_final <- p_menorigual_9 - p_x_menor_8
dbinom(3, size = 11, prob = 1/17)
sum(dbinom(5:9, size=21, prob=1/3))
pbinom(4, size= 7, prob=1/4)
# 2.2: P(X < 3)
pbinom(2, size= 7, prob=1/4)
# 2.3: P(X ≥ 2)
(1 - pbinom(1, size= 7, prob=1/4))
# 2.4: P(X > 3).
(1 - pbinom(3, size= 7, prob=1/4))
# 2.5: P(2 ≤ X ≤ 4) (o, lo que es lo mismo, P((X ≥ 2) ∩ (X ≤ 4))).
(pbinom(4, size= 7, prob=1/4) - (1 - pbinom(1, size= 7, prob=1/4)))
(pbinom(4, size= 7, prob=1/4) - (pbinom(1, size= 7, prob=1/4)))
(probabilidades = 1- pbinom((0:7)-1, size = 7, prob = 1/4))
max(which(probabilidades >= 0.75) )- 1
dbinom(9, size = 10, prob = 0.2)
1 - dbinom(8, size = 10, prob = 0.2)
1 - pbinom(8, size = 10, prob = 0.2)
a <- rnorm(200, mean = 10, sd = 0.2)
a <- rnorm(200, mean = 10, sd = 0.2)
mean(a)
sd(a)
(1 - pbinom(3, size= 7, prob=1/4))
# 2.5: P(2 ≤ X ≤ 4) (o, lo que es lo mismo, P((X ≥ 2) ∩ (X ≤ 4))).
(pbinom(4, size= 7, prob=1/4) - (pbinom(1, size= 7, prob=1/4)))
# 2.6: P(2 < X < 4).
(pbinom(3, size= 7, prob=1/4) - (pbinom(2, size= 7, prob=1/4))
# 2.7: P(2 ≤ X < 4).
(pbinom(3, size= 7, prob=1/4) - (pbinom(1, size= 7, prob=1/4)))
# 2.8: P(2 < X ≤ 4).
(pbinom(4, size= 7, prob=1/4) - (pbinom(2, size= 7, prob=1/4)))
# Ejercicio 4: Por ejemplo, vamos a pensar ahora en la binomial B(7, 1/4) y
# busquemos el mayor valor k para el que se cumple:P(X ≥ k) ≥ 0.75
(probabilidades = 1- pbinom((0:7)-1, size = 7, prob = 1/4))
max(which(probabilidades >= 0.75) )- 1
# Ejercicio 6.1: ¿Cómo de improbable es observar un valor de X mayor o igual a 9
# si X es una binomial B(10, 0.2)? Calcula P(X ≥ 9) para X ∼ B(10, 0.2)
1 - pbinom(8, size = 10, prob = 0.2)
# Ejercicio 6.3: Usando el código que aparece más arriba, fabrica un vector con
# 200 números aleatorios que sigan la distribución B(10, 0.2). Calcula la media
# y desviación típica de esos valores. Compáralos con los valores teóricos.
a <- rnorm(200, mean = 10, sd = 0.2)
mean(a)
sd(a)
dpois(0, lambda = 3)
1 - ppois(5, lamda = 3)
1 - ppois(5, lambda = 3)
ppois(4, lambda = 3) - ppois(1, lambda = 3)
dpois(3, lambda = 3)
dpois(3, lambda = 3)
pnorm(120, mean = 100, sd = 16) - pnorm(90, mean = 100, sd = 16)
1 - pnorm(125, mean = 100, sd = 16)
nc <- 0.95
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa2)
nc <- 0.95
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa_medios)
nc <- 0.95
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa_medios)
mu <- 50
n <- 50
s <- 16
int_izq <- mu - z_alfa2*(s/sqrt(n))
int_dch <- mu + z_alfa2*(s/sqrt(n))
nc <- 0.95
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa_medios)
mu <- 96
n <- 50
s <- 16
int_izq <- mu - z_alfa2*(s/sqrt(n))
int_dch <- mu + z_alfa2*(s/sqrt(n))
pnorm(3100, mean = 2950, sd = 300)
1 - pnorm(3100, mean = 3250, sd = 300) + pnorm(2750, mean = 2950, sd = 300)
pnorm(2750, mean = 2950, sd = 300)
1 - pnorm(3250, mean = 3250, sd = 300)
nc <- 0.90
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa_medios)
mu <- 3000
n <- 40
s <- 300
int_izq <- mu - z_alfa2*(s/sqrt(n))
int_dch <- mu + z_alfa2*(s/sqrt(n))
pnorm(5, mean = 5.8, sd = 1.7)
pnorm(8, mean = 5.8, sd = 1.7) - pnorm(5, mean = 5.8, sd = 1.7)
nc <- 0.95
alfa <- 1-nc
alfa_medios <- alfa/2
z_alfa2 <- qnorm(1-alfa_medios)
mu <- 6
n <- 35
s <- 1.7
int_izq <- mu - z_alfa2*(s/sqrt(n))
int_dch <- mu + z_alfa2*(s/sqrt(n))
# PEC2 - TÉCNICAS DE ANÁLISIS ESTADÍSTICO
# Path
setwd('/Users/miguel.perezibm.com/Desktop/MIGUEL/Courses/Master/03-Tecnicas-Analisis-Estadistico/01-Analisis-Aprendizaje-Estadistico/06-PEC2')
# Paquetes Necesarios
library(readr)
library(dplyr)
library(ggplot2)
library(stringr)
library(magrittr)
library(car)
library(corrplot)
library(psych)
# Abrir los csv y unir
df1 <- read_csv(paste(getwd(), "/life-expectancy-data.csv", sep=""))
df2 <- read_csv(paste(getwd(), "/Pob-Dens-2015.csv", sep=""))
df2015 <- filter(df1, Year == 2015)
df2014 <- filter(df1, Year == 2014)
df <- merge(df2015, df2, by = 'Country')
df_union_2014 <- merge(df2014, df2, by = 'Country')
# Tratamiento de valores nulos
colnames(df)[colSums(is.na(df)) > 0]
# Alcohol
sum(is.na(df$Alcohol))
sum(is.na(df1$Alcohol))
sum(is.na(df_union_2014$Alcohol))
df$Alcohol <- df_union_2014$Alcohol
# HepatitisB
sum(is.na(df$`Hepatitis B`))
sum(is.na(df1$`Hepatitis B`))
# BMI
sum(is.na(df$BMI))
# Total Expenditure
sum(is.na(df$`Total expenditure`))
sum(is.na(df1$`Total expenditure`))
sum(is.na(df_union_2014$`Total expenditure`))
df$`Total expenditure` <- df_union_2014$`Total expenditure`
# GDP
sum(is.na(df$GDP))
sum(is.na(df1$GDP))
# Thinness 1-19 years
sum(is.na(df$`thinness  1-19 years`))
# Thinness 5-9 years
sum(is.na(df$`thinness 5-9 years`))
# Income composition of resources
sum(is.na(df$`Income composition of resources`))
sum(is.na(df1$`Income composition of resources`))
# Schooling
sum(is.na(df$Schooling))
sum(is.na(df1$Schooling))
# Eliminar variables
borrar_variables <- c("Hepatitis B", "GDP", "Population", "Schooling", "Year",
"Income composition of resources", "under-five deaths")
df <- dplyr::select(df, -all_of(borrar_variables))
df <- na.omit(df)
# Variable Status como factor
df$Status <- ifelse(df$Status == 'Developing', 0, 1)
df$Status <- as.factor(df$Status)
# Variable Med Age como Numeric
df$`Med. Age` <- as.numeric(df$`Med. Age`)
df <- df %>% rename_at(vars(c('Status', 'Life expectancy', 'Adult Mortality',
'infant deaths', 'Alcohol',
'percentage expenditure', 'Measles', 'BMI',
'Polio', 'Total expenditure', 'Diphtheria',
'HIV/AIDS',  'Med. Age', 'thinness  1-19 years',
'thinness 5-9 years', 'Poblacion 2015',
'Densidad (P/Km2)', 'Country')),
~ c('des', 'esp', 'mort_a', 'mort_i', 'alc', 'per_exp',
'sar', 'bmi', 'pol', 'tot_exp', 'diph', 'hiv_aids',
'ed_med', 'th5', 'th19', 'pob', 'd_pob', 'pais'))
summary(df)
multi.hist(x = df[,3:8], dcol = c("blue", "red"), dlty = c("dotted", "solid"),
main = c('esp vida', 'mort adulta', 'mort infantil',
'alcohol', 'per exp', 'sar'))
multi.hist(x = df[,9:14], dcol = c("blue", "red"), dlty = c("dotted", "solid"),
main = c('bmi', 'polio', 'tot_exp', 'diphtheria', 'hiv/aids',
'thinness 1-5'))
multi.hist(x = df[,15:18], dcol = c("blue", "red"), dlty = c("dotted", "solid"),
main = c('thinness 1-19', 'edad media', 'poblacion', 'dens pob'))
cor.test(df$th19,df$th5)
df <- dplyr::select(df, -all_of(c("th19", "per_exp")))
# Modelo Inicial
modelo <- lm(formula = esp ~ des + mort_a + mort_i + alc + sar + bmi + pol +
tot_exp + diph + hiv_aids + ed_med + th5 + pob + d_pob,
data = df)
summary(modelo)
# Selección de Variables
step(object = modelo, direction = "both", trace = 0)
# Intervalo de confianza
confint(lm(formula = esp ~ mort_a + tot_exp + diph + hiv_aids + ed_med + th5,
data = df))
# Nuevo Modelo
modelo_final <- lm(formula = esp ~ mort_a + tot_exp + diph + hiv_aids + ed_med +
th5, data = df)
summary(modelo_final)
# Correlación
corrplot(cor(dplyr::select(df, esp, mort_a, tot_exp, diph, hiv_aids, ed_med,
th5)),
method = "number", tl.col = "black")
# Factor de Inflación de la Varianza (VIF)
vif(modelo_final)
